# Автоматический тестировщик для экспериментов

Этот модуль содержит автоматический тестировщик для запуска серии экспериментов с нейро-сотрудником.

## Установка зависимостей

```bash
pip install httpx
```

## Использование

### Запуск всех экспериментов

```bash
python experiment_runner.py --api-key YOUR_PERPLEXITY_API_KEY
```

### Запуск конкретных экспериментов

```bash
python experiment_runner.py --api-key YOUR_PERPLEXITY_API_KEY --experiments 1,2,3
```

### Указание файла для сохранения результатов

```bash
python experiment_runner.py --api-key YOUR_PERPLEXITY_API_KEY --output my_results.json
```

## Список экспериментов

1. **Базовый промпт для анализа лота** - простой анализ без оценок
2. **Расширенный промпт с оценками** - анализ с 10-балльной шкалой
3. **Базовый анализ с temperature=0.1** - низкая temperature для детерминированности
4. **Базовый анализ с temperature=0.5** - повышенная temperature для творчества
5. **Расширенный анализ с temperature=0.1** - расширенный анализ с низкой temperature
6. **Расширенный анализ с temperature=0.7** - расширенный анализ с высокой temperature
7. **Поиск поставщиков (5 компаний)** - поиск 5 поставщиков
8. **Поиск поставщиков (10 компаний)** - поиск 10 поставщиков
9. **Расширенный анализ с sonar-pro** - использование продвинутой модели
10. **Базовый анализ с увеличенным max_tokens** - более подробные ответы

## Формат результатов

Результаты сохраняются в JSON файл со следующей структурой:

```json
{
  "metadata": {
    "total_experiments": 10,
    "successful": 9,
    "failed": 1,
    "timestamp": "2025-11-25T12:00:00",
    "test_lot_data": {...},
    "test_product": "..."
  },
  "experiments": [
    {
      "experiment_id": 1,
      "name": "Базовый промпт для анализа лота",
      "type": "basic_analysis",
      "parameters": {...},
      "prompt": "...",
      "result": "...",
      "duration_seconds": 12.5,
      "timestamp": "2025-11-25T12:00:00",
      "status": "success"
    },
    ...
  ]
}
```

## Анализ результатов

После запуска экспериментов результаты можно проанализировать:

1. Сравнить качество ответов при разных значениях temperature
2. Сравнить результаты базового и расширенного анализа
3. Оценить влияние модели (sonar vs sonar-pro)
4. Проанализировать время выполнения различных экспериментов

